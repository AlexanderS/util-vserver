<?xml version="1.0"?>
<!DOCTYPE cfgdirdoc SYSTEM "configuration.dtd" [
<!ENTITY init-scriptlet-params
	  "<params>
	    <param id='vserver-dir'>
	      <description>The configuration directory of the current vserver</description>
	    </param>
	    <param id='vserver-name'>
	      <description>The name of the current vserver</description>
	    </param>
	    <param id='action'>
	      <description>The fixed value of the current action (e.g. 'prepre-start', 'post-stop', ...).</description>
	    </param>
	  </params>">
<!ENTITY init-script-text     "The scriptlet">
<!ENTITY init-dir-text        "A directory with scriptlets">
<!ENTITY init-dir-script-text "A scriptlet">

<!ENTITY init-prepre-start "which will be executed before the network-interfaces are enabled
	                    and the directories are mounted.">
<!ENTITY init-pre-start  "which will be executed after network-interfaces were enabled and
                          the directories mounted, but before the vserver itself has been
                          started.">
<!ENTITY init-post-start "which will be executed after the vserver has been started.">
<!ENTITY init-pre-stop   "which will be executed before the vserver will be stopped.">
<!ENTITY init-post-stop  "which will be executed after the vserver has been stopped, but
	                  before the directories will be umounted and the the interfaces
                          disabled.">
<!ENTITY init-postpost-stop "which will be executed after the vserver has been stopped
	                     completely.">
]>

<cfgdirdoc>
  <topleveldir type="confdir">
    <description>The base configuration directory.</description>

    <dir name=".defaults" type="fixed" optional="yes">
      <dir name="init" type="fixed">
	<file name="mtab">
	  <description>Default mtab-file</description>
	</file>
      </dir>

      <symlink name="vdirbase">
	<description></description>
	<default>/vservers</default>
      </symlink>

      <dir name="apps" type="fixed">
	<dir name="pkgmgmt" type="fixed">
	  <symlink name="base">
	    <description></description>
	    <default>/vservers/.pkg</default>
	  </symlink>

	  <file name="apt.conf">
	    <description>The default apt.conf which is going to be used. It is overridden by
	    distribution specific configuration file.</description>
	  </file>
	</dir>

	<dir name="debootstrap" type="fixed">
	  <file name="mirror">
	    <description>The Debian mirror which is used for 'debootstrap'.</description>
	  </file>

	  <file name="uri">
	    <description>When the 'debootstrap' package is not installed; fetch it from this uri and
	    install it at a temporary place.</description>
	  </file>
	</dir>

	<dir name="vprocunhide" type="fixed">
	  <file name="files">
	    <description>A list of files which will be made visibly by vprocunhide. Wildcards are
	    allowed and anything ending in '/' will be processed recursively. When this file exists,
	    it overrides the defaults in SYSDEFAULTDIR/vprocunhide-files. The entries there must be
	    absolute filenames inclusive the leading '/proc'.</description>
	  </file>
	</dir>

	<dir name="init" type="fixed">
	  <symlink name="tty">
	    <description>A symlink to the TTY device where input/output will be redirected from/to
	    at startup via initscript.</description>
	  </symlink>
	</dir>

	<dir name="vunify" type="fixed">
	  <file name="exclude">
	    <description>Static list of excluded files.</description>
	  </file>
	</dir>
      </dir>
    </dir>

    <dir name=".distributions" type="fixed" optional="yes">
      <dir name="dist" type="symbolic">
	<file name="dev">
	  <description></description>
	</file>

	<file name="apt.conf">
	  <description>The default apt.conf which is going to be used. It overrides the apt.conf
	  from CONFDIR/.defaults/apps/pkgmgmt.</description>
	</file>

	<script name="initpre">
	  <description>Script which will be executed before packages will be installed.</description>
	  <params>
	    <param id="confdir">
	      <description>The configuration directory of the vserver which is going to be set
	      up.</description>
	    </param>

	    <param id="vserver">
	      <description>The pathname of the vserver binary.</description>
	    </param>
	  </params>
	</script>

	<script name="initpost">
	  <description>Script which will be executed after packages are installed.</description>
	  <params>
	    <param id="confdir">
	      <description>The configuration directory of the vserver which is going to be set
	      up.</description>
	    </param>

	    <param id="vserver">
	      <description>The pathname of the vserver binary.</description>
	    </param>
	  </params>
	</script>

	<dir name="pkgs" type="fixed">
	  <description>Contains files with packages.</description>
	  <file name="list" type="symbolic">
	    <description>File which contains the name of packages. On top of file the special
	    keywords '--reinstall' and '--can-fail' are possible.</description>
	  </file>
	</dir>

	<dir name="pubkeys" type="fixed">
	  <description>Directory with GPG pubkeys which are used to sign the packages of this
	  distribution.</description>
	</dir>

	<dir name="apt" type="fixed">
	  <description>Default content of the /etc/apt/ directory.</description>
	</dir>

	<dir name="rpm" type="fixed">
	  <description>Default content of the /etc/rpm directory.</description>
	</dir>

	<symlink name="rpmlib">
	  <description>Directory which overrides /usr/lib/rpm.</description>
	</symlink>
	
	<symlink name="execdir">
	  <description>Directory with all executables and libraries which are required for this
	  distribution.</description>
	</symlink>
      </dir>
    </dir> <!-- .distributions -->

    <dir name="vserver-name" type="symbolic">
      <description>The configuration directory for the vserver vserver-name.</description>

      <file name="bcapabilities">
	<description>[experimental; name is subject of possible change] Contains the system capabilities.</description>
      </file>

      <file name="ccapabilities">
	<description>[experimental; name is subject of possible change] Contains the context capabilities.</description>
      </file>

      <file name="schedule">
	<description>[experimental; name is subject of possible change] Contains the scheduler
	parameters: fill-rate, interval, tokens, tokens-min, tokens-max and cpu-mask. One parameter
	per line.</description>
      </file>
      
      
      <file name="hostname">
	<description>Contains the hostname of the vserver. Same as uts/nodename.</description>
      </file>

      <file name="name">
	<description>Contains the name of the vserver. When not given, the basename of the directory
	will be assumed as this name.</description>
      </file>

      <file name="domainname">
	<description>The domainname of the vserver. Same as uts/domainname.</description>
      </file>

      <file name="nice">
	<description>The nice-level on which the vserver will be started.</description>
      </file>

      <file name="capabilities">
	<description>Contains per line a capability.</description>
      </file>

      <file name="shell">
	<description>Contains the pathname of the shell which will be used by the "vserver ... enter"
	command.</description>
      </file>

      <file name="flags">
	<description>Contains per line a flag.</description>
      </file>

      <file name="context">
	<description>Contains the context which shall be used for the vserver.</description>
      </file>

      <file name="fstab">
	<description>The fstab file for the vserver. Entries in this file will be mounted within the
	network context of the vserver; this means that mount will be called as 'chbind &lt;options&gt;
	mount ...'. Use the 'fstab.local' file when you do not want this behavior, but in most cases
	the 'fstab' file should be used.</description>
      </file>

      <file name="fstab.local">
	<description>The fstab file for the vserver. In opposite to the normal 'fstab' file, the
	mounting happens in the local network context. Currently there is no way to mix entries of
	both files; 'fstab' will be always processed before 'fstab.local'.</description>
      </file>
      
      <dir name="apps" type="fixed">
	<dir name="init" type="fixed">
	  <file name="mtab">
	    <description>The initial-mtab which will be used for the vserver.</description>
	  </file>

	  <file name="style">
	    <description>Contains the init-style; possible values are 'sysv', 'plain', 'minit' and
	    'gentoo'.</description>
	  </file>

	  <file name="runlevel">
	    <description>The start runlevel.</description>
	  </file>

	  <file name="runlevel.start">
	    <description>The start runlevel.</description>
	  </file>

	  <file name="runlevel.stop">
	    <description>The stop runlevel.</description>
	  </file>

	  <file name="killseq">
	    <description>Contains the 'signal [wait signal]*' sequence which is used to stop the
	    vserver.</description>
	  </file>

	  <file name="cmd.start">
	    <description>The command which is used to start the vserver. Each option must be on a
	    separate line.</description>
	  </file>

	  <file name="cmd.start-sync">
	    <description>The command which is used to wait on the vserver after it has been
	    started. Each option must be on a separate line. This file will be ignored when the
	    'sync' does not exist and the '--sync' option was not used.</description>
	  </file>
	  
	  <file name="cmd.stop">
	    <description>The command which is used to stop the vserver. Each option must be on a
	    separate line.</description>
	  </file>

	  <file name="cmd.stop-sync">
	    <description>The command which is used to wait on the vserver after it has been
	    stopped. Each option must be on a separate line. This file will be ignored when the
	    'sync' does not exist and the '--sync' option was not used.</description>
	  </file>

	  <file name="cmd.prepare">
	    <description>The command which is used to setup the init-system (e.g. to set the runlevel
	    in the utmp-file). Each option must be on a separate line.</description>
	  </file>

	  <file name="sync">
	    <description>Without this file, the 'cmd.*-sync' files will be ignored.</description>
	  </file>

	  <symlink name="tty">
	    <description>A symlink to the TTY device where input/output will be redirected from/to
	    at startup via initscript.</description>
	  </symlink>

	  <file name="mark">
	    <description>This file is used to mark group of vservers which shall be started/stopped
	    together by the initscript. Content is a simple string like 'default'.</description>
	  </file>

	  <file name="depends">
	    <description>This file is used to configure vservers which must be running before the
	    current vserver can be started. At shutdown, the current vserver will be stopped before
	    its dependencies. Content of this file are vserver ids (one name per line).</description>
	  </file>
	</dir> <!-- ...apps/init -->

	<dir name="vshelper" type="fixed">
	  <file name="sync-timeout">
	    <description>The timeout in seconds which is used when synchronising vserver startup/shutdown
	    with the vshelper. When no set, 30 seconds will be assumed.</description>
	  </file>

	  <file name="action">
	    <description>The action which is going to be executed when a vshelper event occurs. The
	    default value is 'restart', but there can be defined own methods by placing scripts into
	    the 'vshelper-methods' directories. These scripts are fed with the same arguments as the
	    'vshelper' script.</description>
	  </file>

	  <script type="symbolic" name="event">
	    <description>When existing. these scripts will be executed *instead* of the default
	    handler defined in 'action'. Their name must match the event which caused the execution
	    of 'vshelper'; e.g. 'restart' or 'poweroff'. See the vs_reboot() function in the kernel
	    for more details.</description>
	    <params>
	      <param id="xid">
		<description>The xid of the context calling the vshelper</description>
	      </param>
	      <param id="event">
		<description>The reboot-event</description>
	      </param>
	    </params>
	  </script>

	  <file name="disabled">
	    <description>When existing, the vshelper functionality will be disabled for this
	    vserver.</description>
	  </file>

	  <file name="warning-disabled">
	    <description>When existing, sanity checks for the vshelper functionality will be
	    skipped.</description>
	  </file>

	  <symlink name="logfile">
	    <description>The file where output will be logged to when 'vshelper' is invoked from the
	    kernel. This should point somewhere e.g. into /var/log.</description>
	  </symlink>
	</dir>

	<dir name="vshelper-methods" type="fixed">
	  <script type="symbolic" name="handler">
	    <description>See vshelper/action.</description>
	    <params>
	    </params>
	  </script>
	</dir>

	<dir name="vunify" type="fixed">
	  <description>This directory contains configuration data required for vserver
	  unification.</description>
	  
	  <file name="exclude">
	    <description>Static list of excluded files. This list supports an rsync syntax: when a
	    file is prefixed by '+', it is a candidate for unification; when there is no prefix or a
	    '-' it will be excluded. Shell-wildcards are allowed for the filenames.</description>
	  </file>

	  <symlink name="refserver.X">
	    <description>These are symlinks to the configuration directory
	    (e.g. CONFDIR/vservers/&lt;idgt;) of a refserver. There may be multiple such symlinks
	    but they must be prefixed by 'refserver.' and will be processed in alphanumerical
	    order.</description>
	  </symlink>
	</dir>
      </dir>

      <dir name="scripts" type="fixed">
	<script name="prepre-start">
	  <description>&init-script-text; &init-prepre-start;</description>
	  &init-scriptlet-params;
	</script>
	<dir name="prepre-start.d" type="fixed">
	  <description>&init-dir-text; &init-prepre-start;</description>

	  <script name="script">
	    <description>&init-dir-script-text; &init-prepre-start;</description>
	    &init-scriptlet-params;
	  </script>
	</dir>

	<script name="pre-start">
	  <description>&init-script-text; &init-pre-start;</description>
	  &init-scriptlet-params;
	</script>

	<dir name="pre-start.d">
	  <description>&init-dir-text; &init-pre-start;</description>
	  
	  <script name="script">
	    <description>&init-dir-script-text; &init-pre-start;</description>
	    &init-scriptlet-params;
	  </script>
	</dir>

	<script name="post-start">
	  <description>&init-script-text; &init-post-start;</description>
	  &init-scriptlet-params;
	</script>

	<dir name="post-start.d">
	  <description>&init-dir-text; &init-post-start;</description>
	  
	  <script name="script">
	    <description>&init-dir-script-text; &init-post-start;</description>
	    &init-scriptlet-params;
	  </script>
	</dir>

	<script name="pre-stop">
	  <description>&init-script-text; &init-pre-stop;</description>
	  &init-scriptlet-params;
	</script>

	<dir name="pre-stop.d" type="fixed">
	  <description>&init-dir-text; &init-pre-stop;</description>
	  <script name="script">
	    <description>&init-dir-script-text; &init-pre-stop;</description>
	    &init-scriptlet-params;
	  </script>
	</dir>

	<script name="post-stop">
	  <description>&init-script-text; &init-post-stop;</description>
	  &init-scriptlet-params;
	</script>

	<dir name="post-stop.d" type="fixed">
	  <description>&init-dir-text; &init-post-stop;</description>
	  <script name="script">
	    <description>&init-dir-script-text; &init-post-stop;</description>
	    &init-scriptlet-params;
	  </script>
	</dir>

	<script name="postpost-stop">
	  <description>&init-script-text; &init-postpost-stop;</description>
	  &init-scriptlet-params;
	</script>

	<dir name="postpost-stop.d" type="fixed">
	  <description>&init-dir-text; &init-postpost-stop;</description>
	  <script name="script">
	    <description>&init-dir-script-text; &init-postpost-stop;</description>
	    &init-scriptlet-params;
	  </script>
	</dir>
      </dir>


      
      <dir name="interfaces" type="fixed">
	<file name="bcast">
	  <description>The deafult broadcast address.</description>
	</file>
	<file name="dev">
	  <description>The default network-device.</description>
	</file>
	<file name="prefix">
	  <description>The default network-prefix.</description>
	</file>
	<file name="mask">
	  <description>The default network-mask.</description>
	</file>
	<file name="scope">
	  <description>The default scope of the network interfaces.</description>
	</file>

	<dir name="iface" type="symbolic">
	  <description>'iface' is an arbitrary name for the interface; the value itself is not important
	  but may be interesting regarding interface-creation and usage with 'chbind'. Both happens in
	  alphabetical order and numbers like '00' are good names for these directories.</description>
	  
	  <file name="disabled">
	    <description>When this file exists, this interface will be ignored.</description>
	  </file>
	  
	  <file name="ip">
	    <description>The ip which will be assigned to this interface.</description>
	  </file>
	  <file name="bcast">
	    <description>The broadcast address.</description>
	  </file>
	  <file name="dev">
	    <description>The network-device.</description>
	  </file>
	  <file name="prefix">
	    <description>The network-prefix.</description>
	  </file>
	  <file name="mask">
	    <description>The network-mask.</description>
	  </file>
	  <file name="scope">
	    <description>The scope of the network interface.</description>
	  </file>
	  <file name="name">
	    <description>When this file exists, the interface will be named with the text in this file.</description>
	  </file>
	  <file name="nodev">
	    <description>When this file exists, the interface will be assumed to exist already. A
	    former name for this flag was 'only_ip' which is deprecated now.</description>
	  </file>
	</dir>
      </dir>

      <dir name="ulimits" type="fixed">
	<description>A directory with ulimits. Possible resources are cpu, data, fsize, locks,
	memlock, nofile, nproc, rss and/or stack.</description>

	<file name="resource" type="symbolic">
	  <description>A file which contains the hard- and soft-limit of the given resource in the
	  first line. The special keyword 'inf' is recognized.</description>
	</file>

	<file name="resource.hard" type="symbolic">
	  <description>A file which contains the hard- of the given resource in the first line. The
	  special keyword 'inf' is recognized.</description>
	</file>

	<file name="resource.soft" type="symbolic">
	  <description>A file which contains the soft- of the given resource in the first line. The
	  special keyword 'inf' is recognized.</description>
	</file>
      </dir>

      <dir name="rlimits" type="fixed">
	<description>see ulimits</description>
      </dir>

      <dir name="uts" type="fixed">
	<file name="context">
	  <description>The context-name of the vserver</description>
	</file>
	<file name="sysname">
	  <description>The sysname of the vserver</description>
	</file>
	<file name="nodename">
	  <description>The node-/hostname of the vserver</description>
	</file>
	<file name="release">
	  <description>The OS-release of the vserver</description>
	</file>
	<file name="version">
	  <description>The OS-version of the vserver</description>
	</file>
	<file name="machine">
	  <description>The machine-type of the vserver</description>
	</file>
	<file name="domainname">
	  <description>The NIS domainname of the vserver</description>
	</file>
      </dir>
    </dir>
  </topleveldir>
</cfgdirdoc>


<!--
!! Local Variables:
!! fill-column: 100
!! End:
-->
